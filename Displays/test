import serial
import time

# ====== CONFIG ======
SERIAL_PORT = "/dev/ttyUSB0"  # Change to your RX ESP32 port
BAUD_RATE = 115200

# ====== CONNECT ======
ser = serial.Serial(SERIAL_PORT, BAUD_RATE, timeout=1)
time.sleep(0.5)  # wait for ESP32 to initialize

# ====== SEND TIME SYNC ======
current_unix_us = int(time.time() * 1_000_000)
command = f"T{current_unix_us}\n"
ser.write(command.encode('ascii'))
print(f"Sent Time Sync: {command.strip()}")

# Optional: read logs from RX
time.sleep(0.1)
while ser.in_waiting:
    print(ser.readline().decode().strip())
